(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9767],{2609:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var r=n(24295),o=n(59499),a=n(27812);n(89858);var c=n(51024);n(45673);var i=n(8448),u=n(77191);n(62713);var l=n(14321),s=n(17621);n(36368);var d=n(4730),p=n(87536),m=n(60099);n(40682),n(71878);var h=n(67294),f=n(29460),b=n(9473),g=n(94386),y=["ref","value"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var DevCreatement_kyj_ReissueCouponListSection=function(e){var t=e.control,n=e.getValues,r=e.storeId,o=e.reissueCouponSelectData,a=e.onAddCoupon,u=e.couponSearchCodeOptions,l=e.reissueSelectList,h=e.handleDeleteCoupon,I=[{title:"유형",dataIndex:"couponType",align:"center",width:150},{title:"쿠폰 명",dataIndex:"couponName",align:"center"},{title:"쿠폰 ID",dataIndex:"couponId",align:"center",width:150},{title:"유효 기간",dataIndex:"startEndDate",align:"center",width:300},{title:"등록일",dataIndex:"couponRegDate",align:"center",width:150},{title:"선택",dataIndex:"",align:"center",width:150,render:function(e,t){var n=t.couponId,r=l.some(function(e){return e.couponId===n});return(0,g.tZ)(s.EK,{name:r?"취소":"선택",type:r&&"danger",onClick:function(){handleSelectStore(t)}})}}],O=(0,b.I0)(),handleSearch=function(e){var t={couponSearchCode:n("couponOption"),searchText:e,storeId:r};console.log(t),O((0,f.e_)({params:t}))},handleSelectStore=function(e){var t={couponType:e.couponType,couponName:e.couponName,couponId:e.couponId};l.some(function(t){return t.couponId===e.couponId})?h(e.couponId):a(t)};return(0,g.BX)(g.HY,{children:[(0,g.tZ)(i.default,{title:"쿠폰 선택"}),(0,g.BX)(s.sw,{css:(0,m.yR)(12),gutter:12,children:[(0,g.tZ)(s.z2,{span:16,css:S}),(0,g.tZ)(s.z2,{span:3,css:m.Bd,children:(0,g.tZ)(p.Qr,{name:"couponOption",control:t,defaultValue:"COUPON_NAME",render:function(e){var t=e.field,n=(t.ref,t.value),r=(0,d.Z)(t,y);return e.fieldState,(0,g.tZ)(s.jL,_objectSpread({value:n,options:u,placeholder:"회원 옵션"},r))}})}),(0,g.tZ)(s.z2,{span:5,children:(0,g.tZ)(p.Qr,{name:"searchText",control:t,render:function(e){var t=e.field;return(0,g.tZ)(c.default.Search,_objectSpread(_objectSpread({},t),{},{type:"text",placeholder:"검색어 입력",onSearch:handleSearch,enterButton:!0}))}})})]}),(0,g.tZ)("div",{css:v,children:(0,g.tZ)(s.wY,{rowKey:"couponId",rowClassName:function(e){return l.some(function(t){return t.couponId===e.couponId})?"highlight-row":""},scroll:{y:250},detail:!1,listData:o,columns:I})})]})},S={name:"s5xdrg",styles:"display:flex;align-items:center"},v={name:"2vme72",styles:".highlight-row,.highlight-row:hover td{background:#b8ccca!important;}"};n(77809);var I=["ref","onChange","value"],O=["ref","value"];function ReissueUserListSection_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ReissueUserListSection_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ReissueUserListSection_ownKeys(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ReissueUserListSection_ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var DevCreatement_kyj_ReissueUserListSection=function(e){var t=e.control,n=e.getValues,r=e.reissueMemberListData,o=e.memberSearchCondOptions,a=e.selectedMemberInfo,u=e.setSelectedMemberInfo,l=e.setReissueSelectList,h=[{title:"회원구분",dataIndex:"memberType",align:"center"},{title:"회원명",dataIndex:"memberName",align:"center",render:function(e,t){return(0,g.tZ)("a",{target:"_blank",href:"/admin/member/".concat(t.memberId),children:e})}},{title:"휴대폰 번호",dataIndex:"memberPhone",align:"center"},{title:"회원 ID",dataIndex:"memberLoginId",align:"center"},{title:"마이 스토어 코드",dataIndex:"memberStoreCode",align:"center"},{title:"마이 스토어",dataIndex:"memberStoreName",align:"center",render:function(e,t){return(0,g.tZ)("a",{target:"_blank",href:"/admin/store/manage/".concat(t.storeId),children:e})}},{title:"선택",dataIndex:"",align:"center",render:function(e,t){return t.memberPhone===(null==a?void 0:a.memberPhone)?(0,g.tZ)(s.EK,{name:"취소",type:"danger",onClick:function(){return handleDeselectMember(t)}}):(0,g.tZ)(s.EK,{name:"선택",onClick:function(){return handleSelectMember(t)}})}}],y=(0,b.I0)(),handleSearch=function(e){var t=n("memberSelectOptions");handleDeselectMember(),y((0,f.oY)({params:{memberSearchCond:t,searchValue:e}}))},handleSelectMember=function(e){var t=e.memberName,n=e.memberPhone,r=e.memberStoreName,o=e.memberStoreCode,a=e.storeId;u({memberName:t,memberPhone:n,memberStoreName:r,memberStoreCode:o,storeId:a,memberId:e.memberId}),l([]),y((0,f.e_)({params:{storeId:a}}))},handleDeselectMember=function(){u(null),l([]),y((0,f._V)())};return(0,g.BX)("div",{css:Z,children:[(0,g.tZ)(i.default,{title:"회원 정보"}),(0,g.BX)(s.sw,{css:(0,m.yR)(12),gutter:12,children:[(0,g.tZ)(s.z2,{span:16,css:w}),(0,g.tZ)(s.z2,{span:3,css:m.Bd,children:(0,g.tZ)(p.Qr,{name:"memberSelectOptions",control:t,defaultValue:"MEMBER_NAME",render:function(e){var t=e.field,n=(t.ref,t.onChange),r=t.value,a=(0,d.Z)(t,I);return e.fieldState,(0,g.tZ)(s.jL,ReissueUserListSection_objectSpread({onChange:function(e){n(e)},value:r,options:o,placeholder:"회원 옵션"},a))}})}),(0,g.tZ)(s.z2,{span:5,children:(0,g.tZ)(p.Qr,{name:"memberSearchText",control:t,render:function(e){var t=e.field,n=(t.ref,t.value),r=(0,d.Z)(t,O);return e.fieldState,(0,g.tZ)(c.default.Search,ReissueUserListSection_objectSpread({type:"text",onSearch:handleSearch,enterButton:!0,placeholder:"검색어 입력",value:n},r))}})})]}),(0,g.tZ)(s.wY,{scroll:{y:250},rowClassName:function(e){return e.memberPhone===(null==a?void 0:a.memberPhone)?"highlight-row":""},detail:!1,listData:r,columns:h}),(0,g.tZ)(s.n,{border:!1}),a&&(0,g.BX)(i.default,{labelStyle:{width:"250px"},bordered:!0,column:8,css:(0,m.Y)(18),children:[(0,g.tZ)(i.default.Item,{span:4,label:"회원명",children:(0,g.tZ)("span",{children:null==a?void 0:a.memberName})}),(0,g.tZ)(i.default.Item,{span:4,label:"휴대폰 번호",children:(0,g.tZ)("span",{children:null==a?void 0:a.memberPhone})}),(0,g.tZ)(i.default.Item,{span:4,label:"마이 스토어",children:(0,g.tZ)("span",{children:null==a?void 0:a.memberStoreName})}),(0,g.tZ)(i.default.Item,{span:4,label:"마이 스토어 코드",children:(0,g.tZ)("span",{children:null==a?void 0:a.memberStoreCode})})]})]})},w={name:"s5xdrg",styles:"display:flex;align-items:center"},Z={name:"2vme72",styles:".highlight-row,.highlight-row:hover td{background:#b8ccca!important;}"},D=n(11163),_=n(27484),j=n.n(_),C=n(64400),P=n(86752),x=n(95966);function PromotionReissueTemplate_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function PromotionReissueTemplate_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PromotionReissueTemplate_ownKeys(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PromotionReissueTemplate_ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var R=l.Z.RangePicker,CampaignTemplate_PromotionReissueTemplate=function(e){(0,u.Z)(e);var t=[{title:"유형",dataIndex:"couponType",align:"center",width:150},{title:"쿠폰명",dataIndex:"couponName",align:"center"},{title:"쿠폰 ID",dataIndex:"couponId",align:"center",width:150},{title:"유효 기간",dataIndex:"eventDate",align:"center",width:300,render:function(e,t){return(0,g.tZ)(i.default.Item,{label:"쿠폰 유효 기간",children:(0,g.tZ)(R,{placeholder:["시작일","종료일"],value:e,format:"YYYY-MM-DD",style:{width:"100%"},onChange:function(e){return handleDateChange(t.couponId,e)}})})}},{title:"수량",dataIndex:"couponQuantity",align:"center",width:150,render:function(e,t){return(0,g.tZ)(c.default,{type:"number",defaultValue:1,min:1,value:e,onChange:function(e){return handleQuantityChange(t.couponId,e.target.value)}})}},{title:"삭제",dataIndex:"couponId",align:"center",width:150,render:function(e,t){return(0,g.tZ)(s.EK,{type:"danger",name:"삭제",onClick:function(){return handleDeleteCoupon(e)}})}}],n=(0,p.cI)({}),r=n.handleSubmit,o=n.control,l=(n.setValue,n.getValues);n.formState.errors;var d=(0,b.I0)(),m=(0,D.useRouter)(),y=(0,C.Z)(["memberSearchCond","couponSearchCode"]),S=y.memberSearchCond,v=y.couponSearchCode,I=(0,h.useState)([]),O=I[0],w=I[1],Z=(0,h.useState)([]),_=Z[0],T=Z[1],E=(0,h.useState)([]),L=E[0],N=E[1],k=(0,h.useState)(null),M=k[0],Y=k[1],K=(0,b.v9)(function(e){return e.campaign.reissueMemberListData}),B=(0,b.v9)(function(e){return e.campaign.reissueCouponSelectData});(0,h.useEffect)(function(){S&&T((0,P.RG)(S))},[S]),(0,h.useEffect)(function(){v&&N((0,P.RG)(v))},[v]);var handleQuantityChange=function(e,t){w(function(n){return n.map(function(n){return n.couponId===e?PromotionReissueTemplate_objectSpread(PromotionReissueTemplate_objectSpread({},n),{},{couponQuantity:t}):n})})},handleDateChange=function(e,t){w(function(n){return n.map(function(n){return n.couponId===e?PromotionReissueTemplate_objectSpread(PromotionReissueTemplate_objectSpread({},n),{},{eventDate:t}):n})})},handleDeleteCoupon=function(e){w(function(t){return t.filter(function(t){return t.couponId!==e})})},handleSendData=function(e){var t=!0,n=O.map(function(e){if(null!=e&&e.eventDate&&2===e.eventDate.length&&e.couponQuantity>0){var n=j()(e.eventDate[0]).format("YYYY-MM-DDT00:00:00"),r=j()(e.eventDate[1]).format("YYYY-MM-DDT23:59:59");return{couponId:e.couponId,startDate:n,endDate:r,couponQuantity:Number(e.couponQuantity)}}t=!1});if(0===O.length){d((0,x.lh)({message:"선택된 쿠폰이 없습니다. 쿠폰을 선택해주세요"}));return}if(t){var r={memberId:null==M?void 0:M.memberId,reissueCouponModels:n};d((0,f.Ws)({sendObject:r,callback:m}))}else{d((0,x.lh)({message:"선택된 쿠폰의 유효기간 및 수량 정보를 정확하게 입력해주세요"}));return}};return(0,g.BX)(s.l0,{onSubmit:r(function(e){return handleSendData(e)},function(e){return handleError(e)}),children:[(0,g.tZ)(s.n,{border:!1}),(0,g.BX)(s._L,{children:[(0,g.tZ)(DevCreatement_kyj_ReissueUserListSection,{control:o,getValues:l,reissueMemberListData:K,memberSearchCondOptions:_,selectedMemberInfo:M,setSelectedMemberInfo:Y,setReissueSelectList:w}),(0,g.tZ)(s.n,{border:!1}),(0,g.tZ)(DevCreatement_kyj_ReissueCouponListSection,{control:o,getValues:l,storeId:null==M?void 0:M.storeId,reissueCouponSelectData:B,onAddCoupon:function(e){var t="".concat(e.couponId,"_").concat(Date.now());w(function(n){return[].concat((0,a.Z)(n),[{key:t,couponType:e.couponType,couponName:e.couponName,couponId:e.couponId,couponQuantity:1}])})},handleDeleteCoupon:handleDeleteCoupon,couponSearchCodeOptions:L,reissueSelectList:O})]}),(0,g.tZ)(s.n,{border:!1}),(0,g.BX)(s._L,{children:[(0,g.tZ)(i.default,{title:"선택 쿠폰",bordered:!1}),(0,g.tZ)(s.wY,{emptyText:"선택된 쿠폰이 없습니다. 쿠폰을 선택해주세요",detail:!1,listData:O,columns:t})]}),(0,g.tZ)(s.n,{border:!1}),(0,g.tZ)(s._L,{children:(0,g.BX)(s.sw,{justify:"space-between",children:[(0,g.tZ)(s.EK,{name:"취소",onClick:function(){return m.push("/admin/campaign/coupon")}}),(0,g.tZ)(s.EK,{type:"primary",name:"발급하기",onClick:handleSendData})]})})]})},coupon_reissue=function(){return(0,g.tZ)(g.HY,{children:(0,g.tZ)(CampaignTemplate_PromotionReissueTemplate,{})})};coupon_reissue.getLayout=function(e){return(0,g.tZ)(r.L,{children:e})};var T=coupon_reissue},47260:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/campaign/coupon/set-reissue",function(){return n(2609)}])}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=47260)}),_N_E=e.O()}]);