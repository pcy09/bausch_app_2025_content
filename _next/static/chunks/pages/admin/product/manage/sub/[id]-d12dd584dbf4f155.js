(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6050],{82617:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return z}});var n=r(24295),l=r(60099);r(70643);var a=r(68469);r(1131);var o=r(28465);r(59567);var u=r(8799);r(45673);var c=r(8448),d=r(4730),i=r(59499);r(53294);var s=r(56697),p=r(50029),f=r(87794),h=r.n(f),m=r(17621),v=r(87536),Z=r(28844),b=r(67294),S=r(9473),y=r(11163);r(71878);var P=r(95966),g=r(86752),w=r(11475),I=r(23430),_=r(88484),C=r(77809),E=r(47255),j=r(27890),G=r(65294),N=r(28245),O=r(18179),k=r(64400),L=r(94386),T=["ref","value","onChange"],D=["ref","value"],B=["ref","value"],x=["ref","value"],K=["ref","value"],Q=["ref","value"],U=["ref","value"],M=["ref","value"],A=["ref","value"],q=["ref","value"],X=["ref","value"],Y=["ref","value"],V=["ref","value"],H=["ref","value","onChange"],R=["ref","value"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ProductManageSalesTemplate(e){var t,r,n=e.types,f=(0,S.I0)(),z=(0,y.useRouter)(),F=(0,b.useState)(null),J=F[0],W=F[1],$=(0,k.Z)(["lensCycle","lensPowerType","storeGroup","productGroupBausch","productGroupLensly"]),ee=$.lensCycle,et=$.lensPowerType,er=$.storeGroup,en=$.productGroupBausch,el=$.productGroupLensly,ea=(0,v.cI)({defaultValues:{productPointPriceGroupModels:[{id:1,storeGroupId:[],pointPrice:""}]}}),eo=(ea.register,ea.handleSubmit),eu=ea.control,ec=ea.setValue,ed=ea.getValues,ei=(ea.formState.errors,ea.watch),es="bausch"===n?en:el,ep=(0,b.useState)([]),ef=ep[0],eh=ep[1],em=(0,b.useState)([]),ev=em[0],eZ=em[1],eb=(0,b.useState)([]),eS=eb[0],ey=eb[1],eP=(0,b.useState)([{id:1,storeGroupId:[],pointPrice:""}]),eg=eP[0];eP[1];var addPurchaseSetting=function(){eE({id:eg.length+1,storeGroupId:[],pointPrice:""})},removePurchaseSetting=function(e){(null==eC?void 0:eC.length)>=2&&ej(e)},ew=(t=(0,p.Z)(h().mark(function _callee(e){var t,r;return h().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(t=new FormData).append("skuInfo",e.file),n.next=4,(0,G.JG)(t);case 4:200===(r=n.sent).status?(ey(r.data.skuInfoModels),f((0,P.nO)({message:"SKU 업로드 성공",description:"SKU 파일이 업로드 되었습니다."}))):f((0,P.lh)({message:"SKU 업로드 실패",description:"SKU 파일 정보를 확인 해보세요."}));case 6:case"end":return n.stop()}},_callee)})),function(e){return t.apply(this,arguments)}),eI={onRemove:function(e){W([]),ey([])},beforeUpload:function(e){return!1},onChange:(r=(0,p.Z)(h().mark(function _callee2(e){var t;return h().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:(t=e.fileList).filter(function(e){return"removed"!==e.status}).length>0&&ew(e),W(t);case 4:case"end":return r.stop()}},_callee2)})),function(e){return r.apply(this,arguments)}),fileList:J};(0,b.useRef)(null);var e_=(0,v.Dq)({control:eu,name:"productPointPriceGroupModels"}),eC=e_.fields,eE=e_.append,ej=e_.remove,addConfirmHandler=function(e){var t=e.productPointPriceGroupModels;0===eS.length&&f((0,P.lh)({message:"SKU 등록이 필요합니다"})),t.some(function(e){var t;return(null==e?void 0:null===(t=e.storeGroupId)||void 0===t?void 0:t.length)===0})&&f((0,P.lh)({message:"스토어 그룹을 선택해주세요."})),t.some(function(e){return!(null!=e&&e.pointPrice)})&&f((0,P.lh)({message:"구매가를 입력해주세요."})),eS.length>0&&t.some(function(e){var t;return(null==e?void 0:null===(t=e.storeGroupId)||void 0===t?void 0:t.length)>0})&&t.some(function(e){return null==e?void 0:e.pointPrice})&&s.Z.confirm({title:"제품 등록",icon:(0,L.tZ)(w.Z,{}),content:"등록하시겠습니까?",okText:"등록",cancelText:"취소",onOk:function(){return handleSendData(e)}})},handleSendData=function(e){var t,r=e.channelType,l=e.productGroupId,a=e.productName,o=e.productNameEn,u=e.productQuantity,c=e.lensPowerType,d=e.salesStatus,s=e.recommendPrice,p=e.finalPrice,h=e.productDescription,m=e.pointOrderable,v=e.minStock,Z=es.find(function(e){return e.value===l}).key,b=null==ee?void 0:ee.find(function(t){return t.value===e.lensCycle}).key,S=Number(u),y=s?Number(s):null,P=p?Number(p):null,g=v?Number(v):null;eC.forEach(function(e,t){null===e.id&&ec("productPointPriceGroupModels[".concat(0,"]"),e.productPointPriceGroupModels)});var w=ed().productPointPriceGroupModels.map(function(e){var t=""===e.storeGroupId?null:Array.isArray(e.storeGroupId)?e.storeGroupId.map(Number):[Number(e.storeGroupId)];return{pointPrice:Number(e.pointPrice)?Number(e.pointPrice):null,storeGroupId:t}}),I="bausch"===n?"productBauschReqDto":"productLenslyReqDto",_=(t={},(0,i.Z)(t,I,{channelType:r,productGroupId:Number(Z),productName:a,productNameEn:o,productQuantity:S,lensPowerType:c,lensCycle:b,salesStatus:d,recommendPrice:y,finalPrice:P,productDescription:""===h?null:h,pointOrderable:m,minStock:g,productPointPriceGroupModels:w}),(0,i.Z)(t,"skuInfoModels",eS),t);"productBauschReqDto"===I?f((0,j.l1)({sendObject:_,callback:z})):f((0,O.Zz)({sendObject:_,callback:z}))},handleError=function(e){console.log(e),null!=e&&e.productGroupId&&f((0,P.lh)({message:"제품 등록 실패",description:"제품 그룹을 입력 해 주세요."})),null!=e&&e.productName&&f((0,P.lh)({message:"제품 등록 실패",description:"제품명을 입력 해 주세요."})),null!=e&&e.productNameEn&&f((0,P.lh)({message:"제품 등록 실패",description:"제품명(영문)을 입력해 주세요."})),null!=e&&e.productQuantity&&f((0,P.lh)({message:"제품 등록 실패",description:"제품 개입을 입력 해주세요."})),null!=e&&e.lensCycle&&f((0,P.lh)({message:"제품 등록 실패",description:"사용주기를 입력 해주세요."}))};(0,b.useEffect)(function(){et&&et.length>0&&eh((0,g.dC)(et)),er&&er.length>0&&eZ((0,g.dC)(er))},[et,er]);var eG=ei("pointOrderable");return(0,b.useEffect)(function(){"bausch"===n&&ec("channelType","BAUSCH"),"lensly"===n&&ec("channelType","LENSLY")},[n]),(0,L.BX)(L.HY,{children:[(0,L.tZ)("div",{css:l.Y2,children:(0,L.tZ)(E.Z,{title:"\uD83D\uDC49\uD83C\uDFFC 바슈롬의 판매 제품을 등록하는 페이지입니다. 바슈롬의 새로운 제품을 등록하세요."})}),(0,L.tZ)(m.n,{border:!1}),(0,L.BX)(Z.Z,{onSubmit:eo(function(e){return addConfirmHandler(e)},function(e){return handleError(e)}),children:[(0,L.BX)(m._L,{bordered:!1,children:[(0,L.BX)(c.default,{title:"제품 정보",labelStyle:{width:"250px"},bordered:!0,column:4,children:[(0,L.tZ)(c.default.Item,{span:2,label:"채널⭐️",children:(0,L.tZ)(v.Qr,{name:"channelType",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=(t.onChange,(0,d.Z)(t,T));return e.fieldState,(0,L.tZ)(m.Tr,_objectSpread({options:[{label:"BAUSCH",value:"BAUSCH"},{label:"LENSLY",value:"LENSLY"}],onChange:function(e){"BAUSCH"===e.target.value?window.location.href="/admin/product/manage/sub/bausch":window.location.href="/admin/product/manage/sub/lensly"},value:r},n))}})}),(0,L.tZ)(c.default.Item,{span:2,label:"제품 그룹⭐️",children:(0,L.tZ)(v.Qr,{name:"productGroupId",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,D);return e.fieldState,(0,L.tZ)(m.jL,_objectSpread({value:r,options:es,placeholder:"제품 그룹을 선택해주세요"},n))},rules:{required:!0}})}),(0,L.tZ)(c.default.Item,{span:2,label:"제품명⭐️",children:(0,L.tZ)(v.Qr,{name:"productName",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value,(0,d.Z)(t,B));return e.fieldState,(0,L.tZ)(m.kq,_objectSpread({type:"text",placeholder:"제품명을 입력해주세요."},r))},rules:{required:!0}})}),(0,L.tZ)(c.default.Item,{span:2,label:"제품명(영문)⭐️",children:(0,L.tZ)(v.Qr,{name:"productNameEn",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value,(0,d.Z)(t,x));return e.fieldState,(0,L.tZ)(m.kq,_objectSpread({type:"text",placeholder:"제품명(영문)을 입력해주세요."},r))},rules:{required:!0}})}),(0,L.tZ)(c.default.Item,{span:2,label:"개입⭐️",children:(0,L.tZ)(v.Qr,{name:"productQuantity",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,K);return e.fieldState,(0,L.tZ)(u.Z,_objectSpread({placeholder:"개입을 입력해주세요.",min:0,style:{width:"100%"},value:r},n))},rules:{required:!0}})}),(0,L.tZ)(c.default.Item,{span:2,label:"도수⭐️",children:(0,L.tZ)(v.Qr,{name:"lensPowerType",control:eu,defaultValue:"MYOPIA",render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,Q);return e.fieldState,(0,L.tZ)(m.Tr,_objectSpread({options:ef,value:r},n))},rules:{required:!0}})}),(0,L.tZ)(c.default.Item,{span:2,label:"사용주기⭐️",children:(0,L.tZ)(v.Qr,{name:"lensCycle",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,U);return e.fieldState,(0,L.tZ)(m.jL,_objectSpread({value:r,options:ee,placeholder:"사용주기를 선택해주세요"},n))},rules:{required:!0}})}),(0,L.tZ)(c.default.Item,{span:2,label:"단종⭐️",children:(0,L.tZ)(v.Qr,{name:"salesStatus",control:eu,defaultValue:"ACTIVE",render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,M);return e.fieldState,(0,L.tZ)(m.Tr,_objectSpread({options:[{label:"단종",value:"DISCONTINUE"},{label:"판매중",value:"ACTIVE"}],value:r},n))},rules:{required:!0}})}),(0,L.tZ)(c.default.Item,{span:2,label:"권장 소비자가",children:(0,L.tZ)(v.Qr,{name:"recommendPrice",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,A);return e.fieldState,(0,L.tZ)(u.Z,_objectSpread({placeholder:"권장 소비자가를 입력해주세요",min:0,style:{width:"100%"},value:r},n))}})}),(0,L.tZ)(c.default.Item,{span:2,label:"최종판매가",children:(0,L.tZ)(v.Qr,{name:"finalPrice",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,q);return e.fieldState,(0,L.tZ)(u.Z,_objectSpread({placeholder:"최종 판매가를 입력해주세요.",min:0,style:{width:"100%"},value:r},n))}})}),(0,L.tZ)(c.default.Item,{span:4,label:"제품설명",children:(0,L.tZ)(v.Qr,{name:"productDescription",control:eu,render:function(e){var t=e.field,r=(t.ref,t.value,(0,d.Z)(t,X));return e.fieldState,(0,L.tZ)(m.FF,_objectSpread({defaultValue:"",placeholder:"제품 설명을 입력해주세요."},r))}})})]}),(0,L.tZ)(m.n,{border:!1}),(0,L.BX)(c.default,{title:"적립제품 설정⭐️",labelStyle:{width:"250px",height:"64px"},bordered:!0,column:4,children:[(0,L.tZ)(c.default.Item,{span:2,label:"주문 가능 여부",children:(0,L.tZ)(v.Qr,{name:"pointOrderable",control:eu,defaultValue:"BUY_ENABLED",render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,Y);return e.fieldState,(0,L.tZ)(m.Tr,_objectSpread({options:[{label:"가능",value:"BUY_ENABLED"},{label:"불가",value:"BUY_DISABLED"}],value:r},n))},rules:{required:!0}})}),"BUY_ENABLED"===eG&&(0,L.tZ)(c.default.Item,{span:2,label:"최소 재고 수량⭐️",children:(0,L.tZ)(v.Qr,{name:"minStock",control:eu,defaultValue:0,render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,V);return e.fieldState,(0,L.tZ)(u.Z,_objectSpread({placeholder:"주문 가능한 최소 재고 수량을 입력해 주세요",min:0,style:{width:"100%"},value:r},n))}})})]}),(0,L.tZ)(m.n,{border:!1}),(0,L.tZ)(c.default,{column:1,title:"적립제품 구매가 설정⭐️",children:eC.map(function(e,t){return(0,L.BX)(m.sw,{children:[(0,L.tZ)(m.z2,{span:10,children:(0,L.tZ)(v.Qr,{name:"productPointPriceGroupModels[".concat(t,"].storeGroupId"),control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=t.onChange,l=(0,d.Z)(t,H);return e.fieldState,(0,L.tZ)(C.Z,_objectSpread({style:{width:"100%"},type:"text",placeholder:"스토어 그룹을 선택해주세요",onChange:function(e){n(e)},value:r,options:ev},l))}})}),(0,L.tZ)(m.z2,{span:10,children:(0,L.tZ)(v.Qr,{name:"productPointPriceGroupModels[".concat(t,"].pointPrice"),control:eu,render:function(e){var t=e.field,r=(t.ref,t.value),n=(0,d.Z)(t,R);return e.fieldState,(0,L.tZ)(u.Z,_objectSpread({placeholder:"구매가를 입력하세요",min:0,style:{width:"100%"},css:(0,l.Lh)(20),value:r},n))}})}),(0,L.BX)(m.z2,{span:3,css:l.Ax,children:[0===t&&(0,L.tZ)(m.EK,{type:"primary",name:"+",onClick:addPurchaseSetting,css:(0,l.Lh)(5)}),0!==t&&(0,L.tZ)(m.EK,{type:"danger",name:"x",onClick:function(){return removePurchaseSetting(t)},css:(0,l.Lh)(5)})]})]},e.id)})}),(0,L.tZ)(m.n,{border:!1}),(0,L.tZ)(c.default,{title:(0,g.X5)("SKU 등록⭐️"),labelStyle:{width:"250px"},bordered:!0,column:4,extra:(0,L.tZ)(m.EK,{type:"solid",name:"샘플 다운로드",icon:(0,L.tZ)(I.Z,{}),htmlType:"button",onClick:g.gp}),children:(0,L.tZ)(c.default.Item,{span:2,label:"SKU 업로드",children:(0,L.tZ)("div",{style:{display:"flex"},children:(0,L.tZ)(o.Z,_objectSpread(_objectSpread({accept:".xlsx",maxCount:1},eI),{},{children:(0,L.tZ)(m.EK,{type:"dashed",name:"SKU 파일 업로드",icon:(0,L.tZ)(_.Z,{})})}))})})})]}),(0,L.tZ)(m.n,{border:!1}),(null==eS?void 0:eS.length)>0&&(0,L.tZ)(a.Z,{defaultActiveKey:["preview"],children:(0,L.tZ)(a.Z.Panel,{header:"SKU 보기",children:(0,L.tZ)(N.Z,{skuList:eS})},"preview")}),(0,L.tZ)(m.n,{border:!1}),(0,L.tZ)(m._L,{size:"default",bordered:!1,children:(0,L.tZ)(m.sw,{children:(0,L.BX)(m.z2,{span:24,css:l.Ax,children:[(0,L.tZ)(m.EK,{type:"default",name:"취소",htmlType:"button",css:(0,l.g4)(5),onClick:function(){return z.push("/admin/product/manage")}}),(0,L.tZ)(m.EK,{type:"primary",name:"등록",htmlType:"submit",css:(0,l.Lh)(5)})]})})})]})]})}var ProductManageCreate=function(){var e=(0,y.useRouter)().query.id;return(0,L.tZ)(L.HY,{children:(0,L.tZ)(ProductManageSalesTemplate,{types:e})})};ProductManageCreate.getLayout=function(e){return(0,L.tZ)(n.L,{children:e})};var z=ProductManageCreate},21678:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/product/manage/sub/[id]",function(){return r(82617)}])}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=21678)}),_N_E=e.O()}]);